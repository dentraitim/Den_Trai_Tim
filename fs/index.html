<!doctype html><link rel=stylesheet href=style.css><title>Đèn Trái Tim - By Big Boss</title><meta charset=utf-8><link rel="shortcut icon"href=heart-icon.png type=image/png><link rel=icon sizes=256x256 href=heart-icon.png><link rel=apple-touch-icon sizes=256x256 href=heart-icon.png><link rel=manifest href=manifest.json><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content=#4527A0><div id=heart></div><div id=main style=display:none><nav class=nav tabindex=-1 onclick=this.focus()><div class=container><a class="pagename current"href=/ >Đèn trái tim</a></div></nav><div class=container><div class=hero><h1>Cài đặt Đèn Trái Tim</h1></div><div class="row form"><div class="col c4"><div class=row><div class="col c12"><form method=post id=ap-form><h2>Phát wifi</h2><div class=form-control><label for=ap-ssid>Tên wifi:</label> <input class=smooth id=ap-ssid required placeholder="Type AP SSID.."></div><div class=form-control><label for=ap-pass>Mật khẩu:</label> <input class=smooth id=ap-pass placeholder="Type AP password.."></div><div class=form-control><button type=submit class="btn btn-sm btn-c">Lưu lại</button></div></form></div><div class="col c12"><h2>Bắt wifi</h2><form method=post id=form><div class=form-control><label for=ssid>Tên wifi:</label> <input class=smooth id=ssid required placeholder="Type WiFi network..."></div><div class=form-control><label for=pass>Mật khẩu:</label> <input class=smooth id=pass placeholder="Type WiFi password..."></div><div class=form-control><button type=submit class="btn btn-sm btn-c">Lưu lại</button></div><h4>Wifi dự phòng 1</h4><div class=form-control><label for=ssid>Tên wifi:</label> <input class=smooth id=ssid1 placeholder="Type WiFi network..."></div><div class=form-control><label for=pass>Mật khẩu:</label> <input class=smooth id=pass1 placeholder="Type WiFi password..."></div><h4>Wifi dự phòng 2</h4><div class=form-control><label for=ssid>Tên wifi:</label> <input class=smooth id=ssid2 placeholder="Type WiFi network..."></div><div class=form-control><label for=pass>Mật khẩu:</label> <input class=smooth id=pass2 placeholder="Type WiFi password..."></div></form></div></div></div><div class="col c8"><button type=button onclick=scanWifi() class="btn btn-sm btn-c"id=scan-wifi>Dò wifi</button> <button type=button onclick=clearLogs() class="btn btn-sm btn-c">Clear</button><div id=scanning-wifi style=display:none><div style="width:250px;margin:0 auto"><div style=display:grid;text-align:center;height:100px><input id=toggle-heart class=twheart type=checkbox> <label for=toggle-heart class=twheart aria-label=like>❤</label></div></div></div><div id=result></div></div></div></div></div><div id=modal-notification class=modal><div class=modal-content><div class=modal-header><span class=close>&times</span><div class=header-txt>Cài đặt thành công</div></div><div class=modal-body><div style="margin:0 auto;width:100%"><img class=gif src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iI0ZGQ0M0RCIgZD0iTTM2IDE4YzAgOS45NDEtOC4wNTkgMTgtMTggMThTMCAyNy45NDEgMCAxOCA4LjA1OSAwIDE4IDBzMTggOC4wNTkgMTggMTgiLz48cGF0aCBmaWxsPSIjNjY0NTAwIiBkPSJNMjIgMjdjMCAyLjc2My0xLjc5MSAzLTQgMy0yLjIxIDAtNC0uMjM3LTQtMyAwLTIuNzYxIDEuNzktNiA0LTYgMi4yMDkgMCA0IDMuMjM5IDQgNnptOC0xMmMtLjEyNCAwLS4yNS0uMDIzLS4zNzEtLjA3Mi01LjIyOS0yLjA5MS03LjM3Mi01LjI0MS03LjQ2MS01LjM3NC0uMzA3LS40Ni0uMTgzLTEuMDgxLjI3Ny0xLjM4Ny40NTktLjMwNiAxLjA3Ny0uMTg0IDEuMzg1LjI3NC4wMTkuMDI3IDEuOTMgMi43ODUgNi41NDEgNC42MjkuNTEzLjIwNi43NjMuNzg3LjU1OCAxLjMtLjE1Ny4zOTItLjUzMy42My0uOTI5LjYzek02IDE1Yy0uMzk3IDAtLjc3Mi0uMjM4LS45MjktLjYyOS0uMjA1LS41MTMuMDQ0LTEuMDk1LjU1Ny0xLjMgNC42MTItMS44NDQgNi41MjMtNC42MDIgNi41NDItNC42MjkuMzA4LS40NTYuOTI5LS41NzcgMS4zODctLjI3LjQ1Ny4zMDguNTgxLjkyNS4yNzUgMS4zODMtLjA4OS4xMzMtMi4yMzIgMy4yODMtNy40NiA1LjM3NEM2LjI1IDE0Ljk3NyA2LjEyNCAxNSA2IDE1eiIvPjxwYXRoIGZpbGw9IiM1REFERUMiIGQ9Ik0yNCAxNmg0djE5bC00LS4wNDZWMTZ6TTggMzVsNC0uMDQ2VjE2SDh2MTl6Ii8+PHBhdGggZmlsbD0iIzY2NDUwMCIgZD0iTTE0Ljk5OSAxOGMtLjE1IDAtLjMwMy0uMDM0LS40NDYtLjEwNS0zLjUxMi0xLjc1Ni03LjA3LS4wMTgtNy4xMDUgMC0uNDk1LjI0OS0xLjA5NS4wNDYtMS4zNDItLjQ0Ny0uMjQ3LS40OTQtLjA0Ny0xLjA5NS40NDctMS4zNDIuMTgyLS4wOSA0LjQ5OC0yLjE5NyA4Ljg5NSAwIC40OTQuMjQ3LjY5NC44NDguNDQ3IDEuMzQyLS4xNzYuMzUtLjUyOS41NTItLjg5Ni41NTJ6bTE0IDBjLS4xNSAwLS4zMDMtLjAzNC0uNDQ2LS4xMDUtMy41MTMtMS43NTYtNy4wNy0uMDE4LTcuMTA1IDAtLjQ5NC4yNDgtMS4wOTQuMDQ3LTEuMzQyLS40NDctLjI0Ny0uNDk0LS4wNDctMS4wOTUuNDQ3LTEuMzQyLjE4Mi0uMDkgNC41MDEtMi4xOTYgOC44OTUgMCAuNDk0LjI0Ny42OTQuODQ4LjQ0NyAxLjM0Mi0uMTc2LjM1LS41MjkuNTUyLS44OTYuNTUyeiIvPjxlbGxpcHNlIGZpbGw9IiM1REFERUMiIGN4PSIxOCIgY3k9IjM0IiByeD0iMTgiIHJ5PSIyIi8+PGVsbGlwc2UgZmlsbD0iI0U3NUE3MCIgY3g9IjE4IiBjeT0iMjciIHJ4PSIzIiByeT0iMiIvPjwvc3ZnPg=="width=150px><div id=success style="width:100px;display:grid;text-align:center;height:100px;margin:0 auto"><input id=toggle-heart-2 class=twheart type=checkbox> <label for=toggle-heart-2 class=twheart aria-label=like>❤</label></div></div><div><p class=modal-txt></div></div><div class=modal-footer></div></div></div><script>window.addEventListener("load",function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("ws.js").then(function(t){console.log("ws scope:",t.scope),t.onupdatefound=function(){var e=t.installing;e.onstatechange=function(){switch(e.state){case"installed":navigator.serviceWorker.controller?console.log("New or updated content is available."):console.log("Content is now available offline!");break;case"redundant":console.error("The installing service worker became redundant.")}}}}).catch(function(e){console.error("Error during service worker registration:",e)})});var heart=document.getElementById("toggle-heart"),heart2=document.getElementById("toggle-heart-2");setInterval(function(){heart.checked=!heart.checked,heart2.checked=!heart2.checked},1e3);var modal=document.getElementById("modal-notification"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"},document.addEventListener("click",function(e){e&&e.target==modal&&(modal.style.display="none")});var loadingHeart=document.getElementById("heart");loadingHeart.style.marginTop=(window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight)/2-60+"px",setTimeout(function(){var e=document.getElementById("main");loadingHeart.style.display="none",e.style.display="";var t=document.getElementsByTagName("body")[0];t.style.background="0",t.style.padding="0"},3e3);var apssid=document.querySelector("#ap-ssid"),appass=document.querySelector("#ap-pass"),apform=document.querySelector("#ap-form"),ssid=document.querySelector("#ssid"),pass=document.querySelector("#pass"),ssid1=document.querySelector("#ssid1"),pass1=document.querySelector("#pass1"),ssid2=document.querySelector("#ssid2"),pass2=document.querySelector("#pass2"),form=document.querySelector("#form"),result=document.querySelector("#result"),msgid=0;function clearLogs(){result.innerHTML="",msgid=0}var log=function(e){if(e){msgid++;var t=document.createElement("span");t.innerHTML=msgid+": "+(""+e).replace(/[<>&]/g,function(e){return{">":"&gt;","<":"&lt;","&":"&amp;"}[e]})+"\n",result.firstChild?result.insertBefore(t,result.firstChild):result.appendChild(t)}};function scanWifi(){var a=document.getElementById("scanning-wifi");a.style.display="";var n=document.getElementById("scan-wifi");if(!n.disabled){n.disabled=!0;var i=new XMLHttpRequest;i.open("GET","/rpc/Wifi.Scan"),i.onreadystatechange=function(){if(4===i.readyState)if(a.style.display="none",n.disabled=!1,i.responseText)try{log("--------------- Danh sách wifi ---------------");for(var e=JSON.parse(i.responseText),t=0,s=e.length;t<s;t++)log(e[t].ssid)}catch(e){log(e)}else log("Request failed. Returned status of "+i.status)},i.send()}}function successNoti(){var e=document.querySelector("#modal-notification"),t=e.querySelector(".modal-header"),s=e.querySelector(".header-txt"),a=e.querySelector(".gif"),n=e.querySelector(".modal-txt"),i=e.querySelector("#success");s.innerHTML="Cài đặt thành công",t.style.backgroundColor="#5cb85c",n.innerHTML="Muội hãy để ý đèn trái tim nhé. Nó sẽ được khởi động lại.<br />Nếu muội thấy nó nhấp nháy thì nó đã khởi động thành công rồi đấy.",i.style.display="grid",a.style.display="none",e.style.display="block"}function failedNoti(){var e=document.querySelector("#modal-notification"),t=e.querySelector(".modal-header"),s=e.querySelector(".header-txt"),a=e.querySelector(".gif"),n=e.querySelector(".modal-txt"),i=e.querySelector("#success");s.innerHTML="Chưa cài được",t.style.backgroundColor="rgb(199, 89, 89)",n.innerHTML="Ồ, hình như muội chưa kết nối tới wifi của đèn trái tim thì phải.<br />Hãy kết nối đến wifi có tên Den_Trai_Tim rồi Tải lại trang này nhé ;)",a.style.display="",i.style.display="none",e.style.display="block"}log("Calling /rpc/Config.Get .."),function(){var t=new XMLHttpRequest;t.open("GET","/rpc/Config.Get"),t.onreadystatechange=function(){if(4===t.readyState)if(t.responseText)try{var e=JSON.parse(t.responseText);log("Result: "+t.responseText),ssid.value=e.wifi.sta.ssid,pass.value=e.wifi.sta.pass,ssid1.value=e.wifi.sta1.ssid,pass1.value=e.wifi.sta1.pass,ssid2.value=e.wifi.sta2.ssid,pass2.value=e.wifi.sta2.pass,apssid.value=e.wifi.ap.ssid,appass.value=e.wifi.ap.pass}catch(e){log(e)}else log("Request failed. Returned status of "+t.status)},t.send()}(),form.addEventListener("submit",function(e){if(e.preventDefault(),ssid.value){var a={wifi:{sta:{enable:!0,ssid:ssid.value,pass:pass.value}}},t=!1;ssid1.value&&(a.wifi.sta1={enable:!0,ssid:ssid1.value,pass:pass1.value},t=!0),ssid2.value&&(a.wifi.sta2={enable:!0,ssid:ssid2.value,pass:pass2.value},t=!0),log("Calling /rpc/Config.Set STA: "+ssid.value+" / "+pass.value+(t?" / and backups":" / no-backups")),function(){var t=form.querySelector('[type="submit"]');if(!t.disabled){t.disabled=!0;var s=new XMLHttpRequest;s.open("POST","/rpc/Config.Set"),s.setRequestHeader("Content-Type","application/json"),s.onreadystatechange=function(){var e;4===s.readyState&&(t.disabled=!1,200===s.status?(successNoti(),log("Success. Saving and rebooting.."),(e=new XMLHttpRequest).open("POST","/rpc/Config.Save"),e.setRequestHeader("Content-Type","application/json"),e.onreadystatechange=function(){4===e.readyState&&(200===e.status?log("Success. Rebooting.."):log("Request failed. Returned status of "+e.status))},e.send(JSON.stringify({reboot:!0}))):(failedNoti(),log("Request failed. Returned status of "+s.status)))},s.send(JSON.stringify({config:a}))}}()}}),apform.addEventListener("submit",function(e){e.preventDefault(),apssid.value&&(log("Calling /rpc/Config.Set AP: "+apssid.value+" / "+appass.value),function(){var t=apform.querySelector('[type="submit"]');if(!t.disabled){t.disabled=!0;var s=new XMLHttpRequest;s.open("POST","/rpc/Config.Set"),s.setRequestHeader("Content-Type","application/json"),s.onreadystatechange=function(){var e;4===s.readyState&&(t.disabled=!1,200===s.status?(successNoti(),log("Success. Saving and rebooting.."),(e=new XMLHttpRequest).open("POST","/rpc/Config.Save"),e.setRequestHeader("Content-Type","application/json"),e.onreadystatechange=function(){4===e.readyState&&(200===e.status?log("Success. Rebooting.."):log("Request failed. Returned status of "+e.status))},e.send(JSON.stringify({reboot:!0}))):(failedNoti(),log("Request failed. Returned status of "+s.status)))},s.send(JSON.stringify({config:{wifi:{ap:{enable:!0,ssid:apssid.value,pass:appass.value}}}}))}}())})</script><script src=love.min.js></script>